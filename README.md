# 使用随机森林、MLP 和 CNN进行组织病理学图像分类(machine learning and data mining课程项目)

## 技术栈
- **语言**: Python  
- **机器学习**: Scikit-learn (Random Forest, GridSearchCV)  
- **深度学习**: TensorFlow / Keras (MLP, CNN, EarlyStopping, Keras Tuner)  
- **工具**: Jupyter Notebook, GitHub  

## 项目角色
- **主要技术贡献者**：负责整个项目的技术实现，包括模型设计、参数调优、性能评估与结果可视化。  
- 实现并对比了 **Random Forest、MLP 与 CNN** 三种方法，主导实验设计与结果分析。  

## 项目简介
本项目是 **machine learning and data mining课程项目**，目标是对病理切片图像（PathMNIST 数据集）进行分类，并比较 **随机森林 (Random Forest)**、**多层感知机 (MLP)** 与 **卷积神经网络 (CNN)** 三种机器学习方法的性能差异。
通过数据预处理、模型搭建与参数调优，我们系统性分析了三种模型在图像分类任务中的优缺点，为后续在医学影像智能诊断中的应用提供参考。

## 数据集
- **来源**: MedMNIST v2 → PathMNIST 子集  
- **数据规模**:  
  - 训练集：32,000 张 (28×28 RGB)  
  - 测试集：8,000 张  
- **类别数**: 9 类（存在一定类别不均衡）  

## 方法与模型
### 1. Random Forest
- 输入为展开后的像素向量  
- 采用 GridSearchCV + 5折交叉验证调参  
- 调整参数: `n_estimators, max_depth, min_samples_split, max_features`  

### 2. MLP
- 输入为原始 RGB 图像 (28×28×3)，经过Flatten 后为一维向量 (2352维)  
- 架构: 输入层 → 2个隐藏层 (ReLU + Dropout) → 输出层 (Softmax)  
- 采用 Keras Tuner 随机搜索 + EarlyStopping（MAX 30 Epoch）
- 调整参数: `隐藏层神经元数, Dropout率, 学习率`

### 3. CNN
- 输入为原始 RGB 图像 (28×28×3)  
- 架构: 多个卷积层 + 池化层 + Dropout + 全连接层 → 输出层  
- 采用 Keras Tuner 随机搜索 + EarlyStopping（MAX 30 Epoch）
- 调整参数: `卷积核数量、Dropout率、学习率`

---

## 实验结果
| 模型 | 测试集准确率 | Macro F1-score | 运行时间 |
|------|------------|----------------|----------|
| Random Forest | 0.66 | 0.63 | ~128s |
| MLP | 0.55 | 0.53 | ~115s |
| CNN | **0.85** | **0.85** | ~571s |

- **CNN 模型**表现最佳，充分发挥了其在空间特征提取和模式识别方面的优势，但训练成本最高，同时存在一定的过拟合风险。  
- **随机森林 (Random Forest)** 排名第二。虽然无法建模空间特征，但依靠集成学习策略在非空间特征上仍取得了不错的结果，适用于效率要求较高的场景。  
- **MLP 模型**表现相对较差。虽然具有一定的非线性建模能力，但无法捕捉空间局部信息，导致分类准确率和 F1 值最低。不过在资源受限的条件下仍有一定选择性。

## 局限性
- **类别不均衡**：虽然 PathMNIST 数据集样本量充足，但类别不平衡问题没有得到专门处理，导致模型对少数类（如 Class 6）的识别能力不足。
- **CNN 存在过拟合**：尽管采用了 Dropout 和 EarlyStopping，但在训练 15 个 epoch 之后，验证集准确率仍出现下降，说明模型复杂度与正则化的平衡尚未达到最佳。

## 未来可改进方向 
- **应对类别不均衡**：引入类别权重调整、数据增强或采用更先进的损失函数（如 Focal Loss），提升 CNN 在小样本类别上的分类能力，避免因召回率低而拉低整体 Macro F1。
- **学习并应用成熟的NN架构**：本项目采用的NN架构较为基础，性能表现一般。未来可以借鉴并复现更成熟的经典网络（如 VGG、ResNet等），以提升特征提取能力和整体性能。  
- **加强图像预处理**：利用缩放、增强、对比度调整等方法提升输入特征的可分辨性，从而增强模型的泛化能力。
- **多模型融合**：结合 CNN 的空间特征提取优势与随机森林的全局分类与高效率特点，尝试集成学习或混合模型，例如将 CNN 提取的高阶特征输入 RF 或 MLP 进行分类，以进一步提升综合性能与实用性。

## 文件结构
- `a2-code-530311278-500312012` : 项目源码pdf版本 (Jupyter Nodebook)  
- `A2-report-530311278-500312012` : 项目报告
- `README.md` : 项目说明文件  

